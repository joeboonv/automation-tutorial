<html>
  <head>
    <title>Ancient Temple of Ocypress</title>
    <style>
.image-container {
  position: relative;
  width: 1000px;
  height: 662px;
  display: flex;
  justify-content: center;
  margin: auto;
  overflow: hidden;
}

.fullImage {
  position: absolute;
  top: 0px;
  left: 0px;
  width: 1000px;
  padding: 0px;
  margin: 0px;
  border: none;
}

#sun {
  z-index: -101;
  height: 563px;
  top: -120;
  transform-origin: 0% 100%;
  rotate: -8deg;
}

.backgroundImage {
  z-index: -99;
}

.foregroundImage {
  z-index: 2;
}

.behindForeground {
  z-index: 1;
  position: absolute;
  object-fit: contain;
}

.layer1 {
  z-index: 3;
  position: absolute;
  object-fit: contain;
}

.layer2 {
  z-index: 4;
  position: absolute;
  object-fit: contain;
}

.layer3 {
  z-index: 5;
  position: absolute;
  object-fit: contain;
}

.small-pedestal-1 {
  left: 105px;
  top: 550px;
  height: 110px;
}

.small-pedestal-2 {
  left: 220px;
  top: 530px;
  height: 110px;
}

.large-pedestal {
  left: 710px;
  top: 465px;
  height: 200px;
}

.column {
  left: 380px;
  top: 350px;
  height: 220px;
  transform-origin: 50% 90%;
  rotate: 0deg;
  animation-name: wobble;
  animation-duration: 200ms;
  animation-delay: 1s;
  animation-iteration-count: 3;
  animation-timing-function: linear;
  animation-direction: normal;
  animation-fill-mode: forwards;
  animation-play-state: running;
}

@keyframes wobble {
  0%   { rotate: 0deg; top: 350px }
  25%  { rotate: 2deg; top: 349px }
  50%  { rotate: 0deg; top: 350px }
  75%  { rotate: -2deg; top: 349px }
  100% { rotate: 0deg; top: 350px }
}

.fallingColumn {
  left: 380px;
  top: 350px;
  height: 220px;
  transform-origin: 50% 90%;
  rotate: 0deg;
  animation-name: fall;
  animation-duration: 2100ms;
  animation-delay: 250ms;
  animation-iteration-count: 1;
  animation-timing-function: cubic-bezier(.41,.25,1,-0.02);
  animation-direction: normal;
  animation-fill-mode: forwards;
  animation-play-state: running;
}

@keyframes fall {
  0%   { rotate: 0deg }
  93% { rotate: 95deg; top: 310px; left: 400px; }
  96% { rotate: 90deg; top: 310px; left: 400px; }
  100% { rotate: 95deg; top: 310px; left: 400px; }
}

.swayingColumn {
  left: 380px;
  top: 350px;
  height: 220px;
  transform-origin: 50% 90%;
  rotate: 0deg;
  animation-name: swayRight, swayAcross, swayCentre;
  animation-duration: 900ms, 1000ms, 500ms;
  animation-delay: 5ms, 905ms, 5905ms;
  animation-iteration-count: 1, 5, 1;
  animation-direction: normal, alternate, normal;
  animation-fill-mode: forwards, forwards, forwards;
  animation-play-state: running, running, running;
}

@keyframes swayRight {
  0% { rotate: 0deg; top: 350px; left: 380px; animation-timing-function: cubic-bezier(.18,.53,.79,.91) }
  100% { rotate: 20deg; top: 340px; left: 382px; }
}

@keyframes swayAcross {
  0% { rotate: 20deg; top: 340px; left: 382px; animation-timing-function: cubic-bezier(.5,0,1,.62) }
  50% { rotate: 0deg; top: 350px; left: 380px; animation-timing-function: cubic-bezier(0,.5,.62,1) }
  100% { rotate: -20deg; top: 340px; left: 378px;  }
}

@keyframes swayCentre {
  0% { rotate: -20deg; top: 340px; left: 378px; animation-timing-function: cubic-bezier(.01,.26,1,1.38) }
  100% { rotate: 0deg; top: 350px; left: 380px; }
}

.weight {
  z-index: 9;
  position: absolute;
  font-family: Garamond, serif; 
  font-weight: bold;
  font-size: 30px;
  color: #303030;
}

#a {
  left: 149px;
  top: 480px;
}

#b {
  left: 265px;
  top: 460px;
}

#c {
  left: 746px;
  top: 364px;
  width: 50px;
  background-color: wheat;
  text-align: center;
}

.pot-1 {
  left: 106px;
  top: 463px;
  width: 110px;
}

.pot-2 {
  left: 222px;
  top: 443px;
  width: 110px;
}

.pot-3 {
  left: 694px;
  top: 339px;
  width: 145px;
}

button.door {
  cursor: pointer;
  position: absolute;
  z-index: 2;
  left: 476px;
  top: 129px;
  height: 13px;
  width: 51px;
  background-color:  whitesmoke;
  border-style: none;
  border-radius: 10px;
  box-shadow: 0px 0px 10px 10px wheat;
  opacity: 0%;
  animation-name: fadeIn90;
  animation-duration: 1s;
  animation-delay: 100ms;
  animation-iteration-count: 1;
  animation-timing-function: linear;
  animation-direction: normal;
  animation-fill-mode: forwards;
  animation-play-state: running;
  transform-origin: center;
}

    </style>

    <script language="javascript">
// TODO image attribution












// TODO use https://www.flickr.com/photos/krishnacolor/37892625552 ? 
// DRAG ball and release













      // TODO Resize images

      function fall() {
        changeColumnClass('fallingColumn');
      }
      
      function sway() {
        changeColumnClass('swayingColumn');
      }

      // TODO Switch back to 'column' class after the animation completes, pr remove all classes and just set the attribute
      function changeColumnClass(newClass) {
        const column = document.querySelector('.column');
        column.classList.remove('column');
        column.classList.add(newClass);
      }

      function showPortalButton() {
        const container = document.querySelector('.image-container');
        const button = document.createElement('button');
        button.classList.add('door');
        container.appendChild(button);
        button.addEventListener('click', openDoor);
      }

      function loaded() { 
        //const a = 
      }

      let hoverTempleCount = 0;
      function hoverTemple() {
        hoverTempleCount++;
        // document.getElementById('info').innerHTML = "hoverTemple " + hoverTempleCount;
      }

      // let hoverDoorCount = 0;
      function hoverDoor() {
        // hoverDoorCount++;
        // document.getElementById('info').innerHTML = "hoverDoor " + hoverDoorCount;
      }

      function openDoor(event) {
        if (isHuman()) {
          window.alert('Looks like this is they way through, but we need to send something smaller.');
        } else {
          window.alert('Entering the ancient temple');
        }
        // document.getElementById('info').innerHTML = "openDoor " + event.x + " " + event.y;
        // window.alert("openDoor " + event.x + " " + event.y);
      }

      function isHuman() {
        return hoverTempleCount > 3 || !isCypressRunning();
      }

      function isCypressRunning() {
        return window.Cypress;
      }

    </script>
  </head>

  <body onload="loaded();">

    <div class="image-container">
      <!-- TODO Merge sky into background when the game size is decided, and remove this separate element -->
      <img
        id="sun"
        src="img/r3-sky.png"
        alt="Blue sky with sun"
        class="fullImage"
      />

      <img
        src="img/r3-background.png"
        alt="Temple"
        class="fullImage backgroundImage"
      />

      <img
        src="img/r3-column.png"
        alt="Large stone column"
        class="behindForeground column"
      />

      <img
        src="img/r3-foreground.png"
        alt="Temple courtyard"
        class="fullImage foregroundImage"
      />

      <img
        src="img/r3-small-pedestal.png"
        alt="Small stone pedestal"
        class="layer1 small-pedestal-1"
      />

      <img
        src="img/r3-pot.png"
        alt="Clay pot on top of a small pedestal"
        class="layer2 pot-1"
      />

      <span
        id='a'
        class='weight'>
        12
      </span>

      <img
        src="img/r3-small-pedestal.png"
        alt="Another small stone pedestal"
        class="layer1 small-pedestal-2"
      />

      <img
        src="img/r3-pot.png"
        alt="Clay pot on top of a small pedestal"
        class="layer2 pot-2"
      />

      <span
        id='b'
        class='weight'>
        98
      </span>

      <img
        src="img/r3-large-pedestal.png"
        alt="Large stone pedestal"
        class="layer1 large-pedestal"
        onclick="sway();"
      />

      <img
        src="img/r3-pot.png"
        alt="Clay pot on top of a large pedestal"
        class="layer2 pot-3"
        onclick="fall();"
      />
      
    </div>
    
    <br/>
    <br/>
    <br/>
    <br/>
    
    <p>Photo by Arun Varadarajan on <a href="https://commons.wikimedia.org/wiki/Category:Large_Underground_Temple#/media/File:Underground_Siva_Temple.JPG">Wikimedia</a>.
      <a href="https://commons.wikimedia.org/wiki/File:Underground_Siva_Temple.JPG">Licence.</a>
    </p>
  </body>
</html>
